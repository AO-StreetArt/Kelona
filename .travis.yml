language: java
jdk:
- oraclejdk8
- oraclejdk9
- openjdk8
addons:
  apt:
    packages:
    - nodejs
services:
- docker
before_install:
- docker network create dvs
- scripts/start_deps.sh
- sleep 10
- docker ps -a
- npm install newman --global;
install:
- ./gradlew assemble
script:
- ./gradlew check
- ./gradlew bootRun &
- sleep 45
- curl http://localhost:5635/health
- cd $TRAVIS_BUILD_DIR/src/test/resources && newman run AssetAPI.postman_collection.json -e AeselTest.postman_environment.json
after_failure:
- docker logs --tail 50 document-db
- docker logs --tail 50 graph-db
- docker logs --tail 150 crazyivan
- docker logs --tail 150 clyman
- cd $TRAVIS_BUILD_DIR && cat logs/avc.log | grep ERROR
